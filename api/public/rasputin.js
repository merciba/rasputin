!function(){"use strict";var rasputin=angular.module("rasputin",["ngMessages","ui.router","ui.bootstrap","LocalStorageModule","ngOboe","ngAnimate"]);rasputin.config(["$locationProvider","localStorageServiceProvider","$urlRouterProvider","$stateProvider",function($locationProvider,localStorageServiceProvider,$urlRouterProvider,$stateProvider){$locationProvider.html5Mode(!0),$locationProvider.hashPrefix("!"),localStorageServiceProvider.setPrefix("rasputin"),$urlRouterProvider.otherwise("/");var getUser=["userService","$rootScope",function(userService,$rootScope){return userService.checkToken().then($rootScope.successHandler)}];$stateProvider.state("home",{url:"/",templateUrl:"templates/home.html",controller:"homeController as vm"}).state("login",{url:"/login",templateUrl:"templates/login.html",controller:"loginController as vm"}).state("signup",{url:"/signup",templateUrl:"templates/signup.html",controller:"signupController as vm"}).state("dashboard",{url:"/dashboard",templateUrl:"templates/dashboard.html",controller:"dashboardController as vm",resolve:{User:getUser}})}]).factory("_",function($window){return $window._}).run(["$rootScope",function($rootScope){$rootScope.successHandler=function(res){return res.data}}])}();
!function(){"use strict";angular.module("rasputin").controller("dashboardController",["$rootScope","$http","$q","_","$window","$state","$scope","transactionService","clientService","invoiceService","notificationService",function($rootScope,$http,$q,_,$window,$state,$scope,transactionService,clientService,invoiceService,notificationService){var vm=this;vm.plaidStatus=!1,vm.freshbooksStatus=!1,vm.transactions=[],vm.clients=[],vm.invoices=[],vm.accounts=[],vm.getAccountName=function(id){return _.find(vm.accounts,{_id:id}).meta.official_name},$("#bank-login").show(),$http.get("/api/dashboard").then($rootScope.successHandler,notificationService.httpRequestError).then(function(dashboard){vm.bankStatus=dashboard.plaidStatus,vm.freshBooksStatus=dashboard.freshBooksStatus;vm.bankStatus&&transactionService.getTransactions().then(function(results){vm.transactions=results.transactions,vm.accounts=results.accounts,$("#bank-login").hide()}),vm.freshBooksStatus&&(clientService.getClients().then(function(clients){vm.clients=clients}),invoiceService.getInvoices().then(function(invoices){vm.invoices=invoices}))},notificationService.httpRequestError)}])}();
!function(){"use strict";angular.module("rasputin").controller("homeController",["$window","$state","$scope",function($window,$state,$scope){}])}();
!function(){"use strict";angular.module("rasputin").controller("loginController",["$window","$state","$scope","userService","localStorageService","notificationService",function($window,$state,$scope,userService,localStorageService,notificationService){var vm=this;vm.loginForm={},vm.login=function(){userService.login(vm.loginForm).then(function(res){localStorageService.set("token",res.token),$state.go("dashboard")},notificationService.error)}}])}();
!function(){"use strict";angular.module("rasputin").controller("signupController",["$window","$state","$scope","userService","localStorageService","notificationService",function($window,$state,$scope,userService,localStorageService,notificationService){var vm=this;vm.signupForm={},vm.signup=function(){vm.signupForm.password===vm.signupForm.confirmPassword&&(delete vm.signupForm.confirmPassword,userService.signup(vm.signupForm).then(function(res){localStorageService.set("token",res.token),$state.go("dashboard")},notificationService.error))}}])}();
!function(){"use strict";angular.module("rasputin").factory("clientService",["$rootScope","$http","$window","localStorageService",function($rootScope,$http,$window,localStorageService){function getClients(){return $http.get("/api/client").then($rootScope.successHandler)}return{getClients:getClients}}])}();
!function(){"use strict";angular.module("rasputin").factory("invoiceService",["$rootScope","$http","$window","localStorageService",function($rootScope,$http,$window,localStorageService){function getInvoices(){return $http.get("/api/invoice").then($rootScope.successHandler)}return{getInvoices:getInvoices}}])}();
!function(){"use strict";angular.module("rasputin").factory("notificationService",["$rootScope","$http","$window","localStorageService",function($rootScope,$http,$window,localStorageService){return $window.toastr&&($window.toastr.options.preventDuplicates=!0),{success:$window.toastr.success,error:$window.toastr.error,httpRequestError:function(error){error.data?$window.toastr.error(error.data):error.message?$window.toastr.error(error.message):$window.toastr.error("Internal Server Error")}}}])}();
!function(){"use strict";angular.module("rasputin").factory("transactionService",["$rootScope","$http","$window","localStorageService",function($rootScope,$http,$window,localStorageService){var getTransactions=function(){return $http.get("/api/transaction").then($rootScope.successHandler)};return{getTransactions:getTransactions}}])}();
!function(){"use strict";angular.module("rasputin").factory("userService",["$rootScope","$http","$window","localStorageService",function($rootScope,$http,$window,localStorageService){var checkToken=function(){return $http.defaults.headers.common.Authorization=localStorageService.get("token"),$http.post("/api/token/authenticate").then($rootScope.successHandler)},signup=function(data){return $http.post("/api/signup",data).then($rootScope.successHandler)},login=function(data){return $http.post("/api/login",data).then($rootScope.successHandler)};return{checkToken:checkToken,signup:signup,login:login}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiY29udHJvbGxlcnMvZGFzaGJvYXJkQ29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL2hvbWVDb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvbG9naW5Db250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvc2lnbnVwQ29udHJvbGxlci5qcyIsInNlcnZpY2VzL2NsaWVudFNlcnZpY2UuanMiLCJzZXJ2aWNlcy9pbnZvaWNlU2VydmljZS5qcyIsInNlcnZpY2VzL25vdGlmaWNhdGlvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy90cmFuc2FjdGlvblNlcnZpY2UuanMiLCJzZXJ2aWNlcy91c2VyU2VydmljZS5qcyJdLCJuYW1lcyI6WyJyYXNwdXRpbiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbG9jYXRpb25Qcm92aWRlciIsImxvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRzdGF0ZVByb3ZpZGVyIiwiaHRtbDVNb2RlIiwiaGFzaFByZWZpeCIsInNldFByZWZpeCIsIm90aGVyd2lzZSIsImdldFVzZXIiLCJ1c2VyU2VydmljZSIsIiRyb290U2NvcGUiLCJjaGVja1Rva2VuIiwidGhlbiIsInN1Y2Nlc3NIYW5kbGVyIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJyZXNvbHZlIiwiVXNlciIsImZhY3RvcnkiLCIkd2luZG93IiwiXyIsInJ1biIsInJlcyIsImRhdGEiLCIkaHR0cCIsIiRxIiwiJHN0YXRlIiwiJHNjb3BlIiwidHJhbnNhY3Rpb25TZXJ2aWNlIiwiY2xpZW50U2VydmljZSIsImludm9pY2VTZXJ2aWNlIiwibm90aWZpY2F0aW9uU2VydmljZSIsInZtIiwidGhpcyIsInBsYWlkU3RhdHVzIiwiZnJlc2hib29rc1N0YXR1cyIsInRyYW5zYWN0aW9ucyIsImNsaWVudHMiLCJpbnZvaWNlcyIsImFjY291bnRzIiwiZ2V0QWNjb3VudE5hbWUiLCJpZCIsImZpbmQiLCJfaWQiLCJtZXRhIiwib2ZmaWNpYWxfbmFtZSIsIiQiLCJzaG93IiwiZ2V0IiwiaHR0cFJlcXVlc3RFcnJvciIsImRhc2hib2FyZCIsImJhbmtTdGF0dXMiLCJmcmVzaEJvb2tzU3RhdHVzIiwiZ2V0VHJhbnNhY3Rpb25zIiwicmVzdWx0cyIsImhpZGUiLCJnZXRDbGllbnRzIiwiZ2V0SW52b2ljZXMiLCJsb2NhbFN0b3JhZ2VTZXJ2aWNlIiwibG9naW5Gb3JtIiwibG9naW4iLCJzZXQiLCJ0b2tlbiIsImdvIiwiZXJyb3IiLCJzaWdudXBGb3JtIiwic2lnbnVwIiwicGFzc3dvcmQiLCJjb25maXJtUGFzc3dvcmQiLCJ0b2FzdHIiLCJvcHRpb25zIiwicHJldmVudER1cGxpY2F0ZXMiLCJzdWNjZXNzIiwibWVzc2FnZSIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInBvc3QiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0ksWUFFQSxJQUFJQSxVQUFXQyxRQUFRQyxPQUFPLFlBQzFCLGFBQ0EsWUFDQSxlQUNBLHFCQUNBLFNBQ0EsYUFHSkYsVUFDS0csUUFDSSxvQkFBcUIsOEJBQStCLHFCQUFzQixpQkFDM0UsU0FBVUMsa0JBQW1CQyw0QkFBNkJDLG1CQUFvQkMsZ0JBQzFFSCxrQkFBa0JJLFdBQVUsR0FDNUJKLGtCQUFrQkssV0FBVyxLQUM3QkosNEJBQTRCSyxVQUFVLFlBRXRDSixtQkFBbUJLLFVBQVUsSUFFN0IsSUFBSUMsVUFBVyxjQUFlLGFBQWMsU0FBVUMsWUFBYUMsWUFBYyxNQUFPRCxhQUFZRSxhQUFhQyxLQUFLRixXQUFXRyxpQkFFaklWLGdCQUNLVyxNQUFNLFFBQ0hDLElBQUssSUFDTEMsWUFBYSxzQkFDYkMsV0FBWSx5QkFFZkgsTUFBTSxTQUNIQyxJQUFLLFNBQ0xDLFlBQWEsdUJBQ2JDLFdBQVksMEJBRWZILE1BQU0sVUFDSEMsSUFBSyxVQUNMQyxZQUFhLHdCQUNiQyxXQUFZLDJCQUVmSCxNQUFNLGFBQ0hDLElBQUssYUFDTEMsWUFBYSwyQkFDYkMsV0FB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QTJCbkUsS0FBS0YsV0FBV0csaUJBRzdEdUQsT0FBUyxTQUFVM0MsTUFDbkIsTUFBT0MsT0FBTXFELEtBQUssY0FBZXRELE1BQU1iLEtBQUtGLFdBQVdHLGlCQUd2RGlELE1BQVEsU0FBVXJDLE1BQ2xCLE1BQU9DLE9BQU1xRCxLQUFLLGFBQWN0RCxNQUFNYixLQUFLRixXQUFXRyxnQkFHMUQsUUFDSUYsV0FBWUEsV0FDWnlELE9BQVFBLE9BQ1JOLE1BQU9BIiwiZmlsZSI6InJhc3B1dGluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgcmFzcHV0aW4gPSBhbmd1bGFyLm1vZHVsZSgncmFzcHV0aW4nLCBbXG4gICAgICAgICduZ01lc3NhZ2VzJyxcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAnTG9jYWxTdG9yYWdlTW9kdWxlJyxcbiAgICAgICAgJ25nT2JvZScsXG4gICAgICAgICduZ0FuaW1hdGUnXG4gICAgXSk7XG5cbiAgICByYXNwdXRpblxuICAgICAgICAuY29uZmlnKFxuICAgICAgICAgICAgWyckbG9jYXRpb25Qcm92aWRlcicsICdsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgXG4gICAgICAgICAgICBmdW5jdGlvbiAoJGxvY2F0aW9uUHJvdmlkZXIsIGxvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCAkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAgICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5oYXNoUHJlZml4KCchJyk7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyLnNldFByZWZpeCgncmFzcHV0aW4nKTtcblxuICAgICAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICAgICAgICAgICAgIHZhciBnZXRVc2VyID0gWyd1c2VyU2VydmljZScsICckcm9vdFNjb3BlJywgZnVuY3Rpb24gKHVzZXJTZXJ2aWNlLCAkcm9vdFNjb3BlKSB7IHJldHVybiB1c2VyU2VydmljZS5jaGVja1Rva2VuKCkudGhlbigkcm9vdFNjb3BlLnN1Y2Nlc3NIYW5kbGVyKTsgfV07XG5cbiAgICAgICAgICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgICAgICAgICAuc3RhdGUoJ2hvbWUnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2hvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUNvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5Db250cm9sbGVyIGFzIHZtJ1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc3RhdGUoJ3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9zaWdudXAnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvc2lnbnVwLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NpZ251cENvbnRyb2xsZXIgYXMgdm0nXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdGF0ZSgnZGFzaGJvYXJkJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2Rhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnZGFzaGJvYXJkQ29udHJvbGxlciBhcyB2bScsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVXNlcjogZ2V0VXNlclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9XSlcbiAgICAgICAgLmZhY3RvcnkoJ18nLCBmdW5jdGlvbigkd2luZG93KSB7IHJldHVybiAkd2luZG93Ll87IH0pXG4gICAgICAgIC5ydW4oWyckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuc3VjY2Vzc0hhbmRsZXIgPSBmdW5jdGlvbiAocmVzKSB7IHJldHVybiByZXMuZGF0YSB9O1xuICAgICAgICB9XSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3Jhc3B1dGluJykuY29udHJvbGxlcignZGFzaGJvYXJkQ29udHJvbGxlcicsXG4gICAgICAgIFsnJHJvb3RTY29wZScsICckaHR0cCcsICckcScsICdfJywgJyR3aW5kb3cnLCAnJHN0YXRlJywgJyRzY29wZScsICd0cmFuc2FjdGlvblNlcnZpY2UnLCAnY2xpZW50U2VydmljZScsICdpbnZvaWNlU2VydmljZScsICdub3RpZmljYXRpb25TZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHAsICRxLCBfLCAkd2luZG93LCAkc3RhdGUsICRzY29wZSwgdHJhbnNhY3Rpb25TZXJ2aWNlLCBjbGllbnRTZXJ2aWNlLCBpbnZvaWNlU2VydmljZSwgbm90aWZpY2F0aW9uU2VydmljZSkge1xuICAgICAgICBcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5wbGFpZFN0YXR1cyA9IGZhbHNlO1xuICAgICAgICB2bS5mcmVzaGJvb2tzU3RhdHVzID0gZmFsc2U7XG5cbiAgICAgICAgdm0udHJhbnNhY3Rpb25zID0gW107XG4gICAgICAgIHZtLmNsaWVudHMgPSBbXTtcbiAgICAgICAgdm0uaW52b2ljZXMgPSBbXTtcbiAgICAgICAgdm0uYWNjb3VudHMgPSBbXTtcbiAgICAgICAgdm0uZ2V0QWNjb3VudE5hbWUgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgICAgIHJldHVybiBfLmZpbmQodm0uYWNjb3VudHMsIHsgX2lkOiBpZCB9KS5tZXRhLm9mZmljaWFsX25hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgJCgnI2JhbmstbG9naW4nKS5zaG93KCk7XG5cbiAgICAgICAgJGh0dHAuZ2V0KFwiL2FwaS9kYXNoYm9hcmRcIilcbiAgICAgICAgXHQudGhlbigkcm9vdFNjb3BlLnN1Y2Nlc3NIYW5kbGVyLCBub3RpZmljYXRpb25TZXJ2aWNlLmh0dHBSZXF1ZXN0RXJyb3IpXG4gICAgICAgIFx0LnRoZW4oZnVuY3Rpb24gKGRhc2hib2FyZCkge1xuICAgICAgICBcdFx0dm0uYmFua1N0YXR1cyA9IGRhc2hib2FyZC5wbGFpZFN0YXR1cztcbiAgICAgICAgXHRcdHZtLmZyZXNoQm9va3NTdGF0dXMgPSBkYXNoYm9hcmQuZnJlc2hCb29rc1N0YXR1cztcbiAgICAgICAgXHRcdHZhciBwcm9taXNlcyA9IFtdO1xuICAgICAgICBcdFx0aWYgKHZtLmJhbmtTdGF0dXMpIHRyYW5zYWN0aW9uU2VydmljZS5nZXRUcmFuc2FjdGlvbnMoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7IFxuICAgICAgICAgICAgICAgICAgICB2bS50cmFuc2FjdGlvbnMgPSByZXN1bHRzLnRyYW5zYWN0aW9uczsgXG4gICAgICAgICAgICAgICAgICAgIHZtLmFjY291bnRzID0gcmVzdWx0cy5hY2NvdW50cztcbiAgICAgICAgICAgICAgICAgICAgJCgnI2JhbmstbG9naW4nKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIFx0XHRpZiAodm0uZnJlc2hCb29rc1N0YXR1cykge1xuICAgICAgICBcdFx0XHRjbGllbnRTZXJ2aWNlLmdldENsaWVudHMoKS50aGVuKGZ1bmN0aW9uIChjbGllbnRzKSB7IHZtLmNsaWVudHMgPSBjbGllbnRzOyB9KTtcbiAgICAgICAgXHRcdFx0aW52b2ljZVNlcnZpY2UuZ2V0SW52b2ljZXMoKS50aGVuKGZ1bmN0aW9uIChpbnZvaWNlcykgeyB2bS5pbnZvaWNlcyA9IGludm9pY2VzOyB9KTtcbiAgICAgICAgXHRcdH1cbiAgICAgICAgXHR9LCBub3RpZmljYXRpb25TZXJ2aWNlLmh0dHBSZXF1ZXN0RXJyb3IpO1xuICAgIH1dKTtcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdyYXNwdXRpbicpLmNvbnRyb2xsZXIoJ2hvbWVDb250cm9sbGVyJyxcbiAgICAgICAgWyckd2luZG93JywgJyRzdGF0ZScsICckc2NvcGUnLFxuICAgICAgICBmdW5jdGlvbigkd2luZG93LCAkc3RhdGUsICRzY29wZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgIH1dKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3Jhc3B1dGluJykuY29udHJvbGxlcignbG9naW5Db250cm9sbGVyJyxcbiAgICAgICAgWyckd2luZG93JywgJyRzdGF0ZScsICckc2NvcGUnLCAndXNlclNlcnZpY2UnLCAnbG9jYWxTdG9yYWdlU2VydmljZScsICdub3RpZmljYXRpb25TZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCAkc2NvcGUsIHVzZXJTZXJ2aWNlLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlLCBub3RpZmljYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ubG9naW5Gb3JtID0ge307XG5cbiAgICAgICAgdm0ubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIFx0dXNlclNlcnZpY2UubG9naW4odm0ubG9naW5Gb3JtKVxuICAgIFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICBcdFx0XHRcdGxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCd0b2tlbicsIHJlcy50b2tlbik7XG4gICAgXHRcdFx0XHQkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgIFx0XHRcdH0sIG5vdGlmaWNhdGlvblNlcnZpY2UuZXJyb3IpO1xuICAgIFx0fTtcbiAgICB9XSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgncmFzcHV0aW4nKS5jb250cm9sbGVyKCdzaWdudXBDb250cm9sbGVyJyxcbiAgICAgICAgWyckd2luZG93JywgJyRzdGF0ZScsICckc2NvcGUnLCAndXNlclNlcnZpY2UnLCAnbG9jYWxTdG9yYWdlU2VydmljZScsICdub3RpZmljYXRpb25TZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24oJHdpbmRvdywgJHN0YXRlLCAkc2NvcGUsIHVzZXJTZXJ2aWNlLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlLCBub3RpZmljYXRpb25TZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0uc2lnbnVwRm9ybSA9IHt9O1xuXG4gICAgICAgIHZtLnNpZ251cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgXHRpZiAodm0uc2lnbnVwRm9ybS5wYXNzd29yZCA9PT0gdm0uc2lnbnVwRm9ybS5jb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgXHRcdGRlbGV0ZSB2bS5zaWdudXBGb3JtLmNvbmZpcm1QYXNzd29yZDtcbiAgICAgICAgXHRcdHVzZXJTZXJ2aWNlLnNpZ251cCh2bS5zaWdudXBGb3JtKVxuICAgICAgICBcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIFx0XHRcdFx0bG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3Rva2VuJywgcmVzLnRva2VuKTtcbiAgICAgICAgXHRcdFx0XHQkc3RhdGUuZ28oJ2Rhc2hib2FyZCcpO1xuICAgICAgICBcdFx0XHR9LCBub3RpZmljYXRpb25TZXJ2aWNlLmVycm9yKTtcbiAgICAgICAgXHR9XG4gICAgICAgIH07XG4gICAgfV0pO1xufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3Jhc3B1dGluJykuZmFjdG9yeSgnY2xpZW50U2VydmljZScsXG4gICAgICAgIFsnJHJvb3RTY29wZScsICckaHR0cCcsICckd2luZG93JywgJ2xvY2FsU3RvcmFnZVNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbigkcm9vdFNjb3BlLCAkaHR0cCwgJHdpbmRvdywgbG9jYWxTdG9yYWdlU2VydmljZSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldENsaWVudHMgKCkgeyByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NsaWVudCcpLnRoZW4oJHJvb3RTY29wZS5zdWNjZXNzSGFuZGxlcikgOyB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgXHRnZXRDbGllbnRzOiBnZXRDbGllbnRzXG4gICAgICAgIH1cbiAgICB9XSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgncmFzcHV0aW4nKS5mYWN0b3J5KCdpbnZvaWNlU2VydmljZScsXG4gICAgICAgIFsnJHJvb3RTY29wZScsICckaHR0cCcsICckd2luZG93JywgJ2xvY2FsU3RvcmFnZVNlcnZpY2UnLFxuICAgICAgICBmdW5jdGlvbigkcm9vdFNjb3BlLCAkaHR0cCwgJHdpbmRvdywgbG9jYWxTdG9yYWdlU2VydmljZSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEludm9pY2VzICgpIHsgcmV0dXJuICRodHRwLmdldCgnL2FwaS9pbnZvaWNlJykudGhlbigkcm9vdFNjb3BlLnN1Y2Nlc3NIYW5kbGVyKTsgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgIFx0Z2V0SW52b2ljZXM6IGdldEludm9pY2VzXG4gICAgICAgIH1cbiAgICB9XSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgncmFzcHV0aW4nKS5mYWN0b3J5KCdub3RpZmljYXRpb25TZXJ2aWNlJyxcbiAgICAgICAgWyckcm9vdFNjb3BlJywgJyRodHRwJywgJyR3aW5kb3cnLCAnbG9jYWxTdG9yYWdlU2VydmljZScsXG4gICAgICAgIGZ1bmN0aW9uKCRyb290U2NvcGUsICRodHRwLCAkd2luZG93LCBsb2NhbFN0b3JhZ2VTZXJ2aWNlKSB7XG4gICAgICAgIGlmICgkd2luZG93LnRvYXN0cikgJHdpbmRvdy50b2FzdHIub3B0aW9ucy5wcmV2ZW50RHVwbGljYXRlcyA9IHRydWU7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6ICR3aW5kb3cudG9hc3RyLnN1Y2Nlc3MsXG4gICAgICAgICAgICBlcnJvcjogJHdpbmRvdy50b2FzdHIuZXJyb3IsXG4gICAgICAgICAgICBodHRwUmVxdWVzdEVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAoZXJyb3IuZGF0YSkgJHdpbmRvdy50b2FzdHIuZXJyb3IoZXJyb3IuZGF0YSk7XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoZXJyb3IubWVzc2FnZSkgJHdpbmRvdy50b2FzdHIuZXJyb3IoZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgZWxzZSAkd2luZG93LnRvYXN0ci5lcnJvcihcIkludGVybmFsIFNlcnZlciBFcnJvclwiKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgncmFzcHV0aW4nKS5mYWN0b3J5KCd0cmFuc2FjdGlvblNlcnZpY2UnLFxuICAgICAgICBbJyRyb290U2NvcGUnLCAnJGh0dHAnLCAnJHdpbmRvdycsICdsb2NhbFN0b3JhZ2VTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHAsICR3aW5kb3csIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgZ2V0VHJhbnNhY3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBcdHJldHVybiAkaHR0cC5nZXQoXCIvYXBpL3RyYW5zYWN0aW9uXCIpLnRoZW4oJHJvb3RTY29wZS5zdWNjZXNzSGFuZGxlcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgXHRnZXRUcmFuc2FjdGlvbnM6IGdldFRyYW5zYWN0aW9uc1xuICAgICAgICB9XG4gICAgfV0pO1xufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ3Jhc3B1dGluJykuZmFjdG9yeSgndXNlclNlcnZpY2UnLFxuICAgICAgICBbJyRyb290U2NvcGUnLCAnJGh0dHAnLCAnJHdpbmRvdycsICdsb2NhbFN0b3JhZ2VTZXJ2aWNlJyxcbiAgICAgICAgZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHAsICR3aW5kb3csIGxvY2FsU3RvcmFnZVNlcnZpY2UpIHtcblxuICAgICAgICB2YXIgY2hlY2tUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydBdXRob3JpemF0aW9uJ10gPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgndG9rZW4nKTtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Rva2VuL2F1dGhlbnRpY2F0ZScpLnRoZW4oJHJvb3RTY29wZS5zdWNjZXNzSGFuZGxlcik7XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICB2YXIgc2lnbnVwID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3NpZ251cCcsIGRhdGEpLnRoZW4oJHJvb3RTY29wZS5zdWNjZXNzSGFuZGxlcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGxvZ2luID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2xvZ2luJywgZGF0YSkudGhlbigkcm9vdFNjb3BlLnN1Y2Nlc3NIYW5kbGVyKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY2hlY2tUb2tlbjogY2hlY2tUb2tlbixcbiAgICAgICAgICAgIHNpZ251cDogc2lnbnVwLFxuICAgICAgICAgICAgbG9naW46IGxvZ2luXG4gICAgICAgIH1cbiAgICB9XSk7XG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
